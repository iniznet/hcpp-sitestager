# HestiaCP User Usage Stats Plugin (hcpp-usagestats)

This is a plugin for the [Hestia Control Panel](https://hestiacp.com) that provides users with a detailed, real-time dashboard of their resource consumption. It is built upon the `hestiacp-pluginable` framework.

The plugin adds a clean, responsive panel to the top of the "Web" tab, showing live statistics that automatically refresh every 5 seconds. This gives users immediate insight into how their applications are performing and how close they are to their package limits.

![HestiaCP User Usage Stats Plugin](https://raw.githubusercontent.com/iniznet/hcpp-usagestats/main/screenshot.png)

---

## Features

### Real-Time Usage Monitoring
-   **CPU Usage:** See the total CPU percentage currently being used by all of your processes, compared against your package limit.
-   **Memory Usage:** View your current memory consumption in MB, compared against your package limit.
-   **Live Processes:** A live count of your active processes.
-   **Disk I/O:** Monitor the current disk read/write activity (in KB/s) generated by your account to identify disk-heavy scripts.
-   **Open Files:** See the total number of files currently opened by your processes, useful for debugging "Too many open files" errors.

### Package Quota Display
-   **Web Domains:** A progress bar showing how many web domains you have used versus your package limit.
-   **Databases:** A progress bar showing your current database count against your limit.
-   **Disk Usage:** A progress bar displaying your total disk space used compared to your quota.

---

## Requirements

-   Hestia Control Panel v1.9.X or greater.
-   **[hestiacp-pluginable](https://github.com/virtuosoft-dev/hestiacp-pluginable)** must be installed first.
-   Ubuntu or Debian Linux OS.
-   The `iotop` utility. The installer will attempt to add this for you.

## Installation

1.  SSH into your HestiaCP server with `root` or `sudo` access.
2.  Navigate to the Hestia plugins directory:
    ```bash
    cd /usr/local/hestia/plugins
    ```
3.  Clone this repository:
    ```bash
    sudo git clone https://github.com/iniznet/hcpp-usagestats.git usagestats
    ```
4.  **Set Permissions:** Ensure the install/uninstall scripts are executable.
    ```bash
    sudo chmod +x usagestats/install usagestats/uninstall
    ```
5.  **Run the Installer:** This will ensure the `iotop` dependency is met.
    ```bash
    sudo /usr/local/hestia/plugins/usagestats/install
    ```
6.  Log in to HestiaCP. The new usage panel will automatically appear on the **WEB** tab.

## Usage

Simply navigate to the **WEB** section of the Hestia Control Panel after logging in. The resource usage panel will be displayed at the top of the page and will update automatically. If you are an administrator impersonating another user, the panel will correctly show the stats for the user you are viewing.

## Uninstallation

1.  Run the uninstallation script:
    ```bash
    sudo /usr/local/hestia/plugins/usagestats/uninstall
    ```
2.  Remove the plugin directory:
    ```bash
    sudo rm -rf /usr/local/hestia/plugins/usagestats
    ```